{
  "version": "4.0",
  "created": "2025-12-09 15:30:00",
  "project": "IQFMP 智能量化因子挖掘平台",
  "total_estimated_days": 53,
  "tasks": [
    {
      "id": "0",
      "title": "初始化项目结构与开发环境",
      "description": "创建 Python 项目骨架，配置 pyproject.toml，设置 Docker Compose 开发环境 (TimescaleDB, Redis, Qdrant)，配置 pre-commit hooks 和 CI 基础",
      "complexity": 3,
      "priority": "P0",
      "dependencies": [],
      "estimated_days": 1,
      "status": "completed",
      "type": "architecture",
      "trace_to": "specs/architecture.md#project-structure",
      "completed_at": "2025-12-09T22:55:00"
    },
    {
      "id": "1",
      "title": "实现 AST 安全检查器 (严格模式 Layer 1)",
      "description": "实现 ASTSecurityChecker 类，禁止危险函数 (eval/exec/os.system) 和危险模块导入，提供详细的违规报告。这是 LLM 生成代码的第一道防线。",
      "complexity": 5,
      "priority": "P0",
      "dependencies": ["0"],
      "estimated_days": 2,
      "status": "completed",
      "type": "feature",
      "trace_to": "specs/architecture.md#code-execution-safety",
      "completed_at": "2025-12-09T23:10:00"
    },
    {
      "id": "2",
      "title": "实现沙箱执行器 (严格模式 Layer 2)",
      "description": "基于 RestrictedPython 实现 SandboxExecutor，限制可访问的模块和函数，配置资源限制 (CPU/Memory/Timeout)，确保因子代码在隔离环境中执行。",
      "complexity": 6,
      "priority": "P0",
      "dependencies": ["1"],
      "estimated_days": 2,
      "status": "completed",
      "type": "feature",
      "trace_to": "specs/architecture.md#code-execution-safety",
      "completed_at": "2025-12-09T23:45:00"
    },
    {
      "id": "3",
      "title": "实现人工审核网关 (严格模式 Layer 3)",
      "description": "实现 HumanReviewGate 类，生成代码摘要，发送 Telegram/Slack 通知，等待人工确认后才执行。包含审核队列管理和超时处理。",
      "complexity": 5,
      "priority": "P0",
      "dependencies": ["2"],
      "estimated_days": 2,
      "status": "completed",
      "type": "feature",
      "trace_to": "specs/architecture.md#code-execution-safety",
      "completed_at": "2025-12-10T00:15:00"
    },
    {
      "id": "4",
      "title": "搭建 Qlib Deep Fork 基础结构",
      "description": "Fork Qlib 仓库，创建 qlib-crypto 目录结构，实现 CryptoDataHandler 骨架类，配置上游同步脚本，设置 CI 测试流程。",
      "complexity": 6,
      "priority": "P0",
      "dependencies": ["0"],
      "estimated_days": 3,
      "status": "completed",
      "type": "architecture",
      "trace_to": "specs/architecture.md#qlib-deep-fork",
      "completed_at": "2025-12-10T00:35:00"
    },
    {
      "id": "5",
      "title": "实现 CryptoDataHandler 完整功能",
      "description": "扩展 DataHandlerLP 支持加密货币字段 (funding_rate, open_interest, basis)，实现资金费率时间对齐处理，支持多交易所数据格式。",
      "complexity": 7,
      "priority": "P0",
      "dependencies": ["4"],
      "estimated_days": 3,
      "status": "completed",
      "type": "feature",
      "trace_to": "specs/architecture.md#qlib-deep-fork",
      "started_at": "2025-12-10T01:00:00",
      "completed_at": "2025-12-10T01:30:00"
    },
    {
      "id": "6",
      "title": "配置 OpenRouter LLM 集成",
      "description": "实现 LLMProvider 类，配置多模型切换 (DeepSeek/Claude/GPT)，实现 Fallback 链，添加请求缓存和速率限制。",
      "complexity": 4,
      "priority": "P0",
      "dependencies": ["0"],
      "estimated_days": 2,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/architecture.md#llm-provider-strategy"
    },
    {
      "id": "7",
      "title": "实现 LangGraph Agent 编排框架",
      "description": "搭建 StateGraph 基础，实现 AgentOrchestrator 类，配置 PostgresSaver 状态持久化，支持 checkpoint 和 time-travel 调试。",
      "complexity": 7,
      "priority": "P0",
      "dependencies": ["0"],
      "estimated_days": 3,
      "status": "pending",
      "type": "architecture",
      "trace_to": "specs/architecture.md#langgraph-state-persistence"
    },
    {
      "id": "8",
      "title": "实现自然语言因子生成 (User Story 1.1)",
      "description": "实现 FactorGenerationAgent，支持自然语言输入，Prompt 模板渲染，调用 LLM 生成 Qlib 兼容因子代码，集成 AST 安全检查。",
      "complexity": 7,
      "priority": "P0",
      "dependencies": ["3", "6", "7"],
      "estimated_days": 3,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/product.md#user-story-11"
    },
    {
      "id": "9",
      "title": "实现因子家族约束生成 (User Story 1.2)",
      "description": "定义 6 大因子家族及其数据字段，实现家族选择 UI/API，在 Prompt 中注入家族约束，验证生成代码只使用允许的字段。",
      "complexity": 5,
      "priority": "P0",
      "dependencies": ["8"],
      "estimated_days": 2,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/product.md#user-story-12"
    },
    {
      "id": "10",
      "title": "实现 CryptoCVSplitter 多切片验证 (User Story 2.1)",
      "description": "实现时间切分 (Train/Valid/Test)、市场切分 (BTC/ETH + Altcoins)、频率切分 (1h/4h/1d)，生成多维度切片组合。",
      "complexity": 6,
      "priority": "P0",
      "dependencies": ["5"],
      "estimated_days": 3,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/product.md#user-story-21"
    },
    {
      "id": "11",
      "title": "实现 Research Ledger 研究账本 (User Story 2.2)",
      "description": "实现 ResearchLedger 类，记录每次因子评估，追踪全局试验次数 N，实现动态阈值计算 (Deflated Sharpe Ratio 简化版)。",
      "complexity": 6,
      "priority": "P0",
      "dependencies": ["0"],
      "estimated_days": 3,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/product.md#user-story-22"
    },
    {
      "id": "12",
      "title": "实现 StabilityAnalyzer 稳定性分析 (User Story 2.3)",
      "description": "实现时间稳定性 (按月/季度 IC)、市场稳定性 (大/中/小市值)、环境稳定性 (regime 划分) 分析，生成可视化报告。",
      "complexity": 6,
      "priority": "P0",
      "dependencies": ["10"],
      "estimated_days": 3,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/product.md#user-story-23"
    },
    {
      "id": "13",
      "title": "实现 FactorEvaluator 因子评估引擎",
      "description": "整合 CryptoCVSplitter、ResearchLedger、StabilityAnalyzer，实现完整的因子评估流程，计算 IC/IR/Sharpe 等指标，生成 FactorReport。",
      "complexity": 7,
      "priority": "P0",
      "dependencies": ["10", "11", "12"],
      "estimated_days": 3,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/architecture.md#factor-evaluation-engine"
    },
    {
      "id": "14",
      "title": "实现因子选择组合功能 (S-001)",
      "description": "实现因子库筛选 (按家族/稳定性/IC)，因子相关性矩阵计算，高相关因子警告，手动/自动因子组合选择。",
      "complexity": 5,
      "priority": "P0",
      "dependencies": ["13"],
      "estimated_days": 2,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/product.md#user-story-31"
    },
    {
      "id": "15",
      "title": "实现策略代码自动生成 (S-002)",
      "description": "LLM 生成多因子策略框架代码，支持因子加权组合，生成符合 Qlib Strategy 规范的代码，集成安全检查。",
      "complexity": 6,
      "priority": "P0",
      "dependencies": ["8", "14"],
      "estimated_days": 3,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/product.md#user-story-32"
    },
    {
      "id": "16",
      "title": "实现开平仓止盈止损逻辑 (S-003)",
      "description": "实现多空双向信号，自定义止盈止损条件，仓位管理 (凯利公式/固定比例)，时间止损支持。",
      "complexity": 5,
      "priority": "P0",
      "dependencies": ["15"],
      "estimated_days": 2,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/product.md#user-story-33"
    },
    {
      "id": "17",
      "title": "实现策略回测引擎 (S-004)",
      "description": "实现多空双向回测，计算完整绩效指标 (Sharpe/MaxDD/Win Rate)，分时段/分市场绩效分解，生成可视化回测报告。",
      "complexity": 6,
      "priority": "P0",
      "dependencies": ["16"],
      "estimated_days": 3,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/product.md#user-story-34"
    },
    {
      "id": "18",
      "title": "实现 ccxt 交易所连接 (T-001)",
      "description": "实现 Binance Futures 和 OKX Swap API 连接，统一的交易所抽象接口 ExchangeAdapter，自动重连机制和错误处理。",
      "complexity": 5,
      "priority": "P0",
      "dependencies": ["0"],
      "estimated_days": 2,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/product.md#user-story-41-t-001"
    },
    {
      "id": "19",
      "title": "实现多空订单执行 (T-002)",
      "description": "实现限价/市价订单，开多/开空/平多/平空操作，订单状态追踪，部分成交处理，订单超时取消。",
      "complexity": 5,
      "priority": "P0",
      "dependencies": ["18"],
      "estimated_days": 2,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/product.md#user-story-42-t-002"
    },
    {
      "id": "20",
      "title": "实现持仓与 PnL 监控 (T-003)",
      "description": "实时持仓同步，未实现/已实现 PnL 计算，保证金使用率监控，WebSocket 实时推送。",
      "complexity": 5,
      "priority": "P0",
      "dependencies": ["19"],
      "estimated_days": 2,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/product.md#user-story-43-t-003"
    },
    {
      "id": "21",
      "title": "实现风控检查模块 (T-004)",
      "description": "实现 RiskController 类，最大回撤限制 (20%)，单笔亏损上限 (2%)，持仓集中度检查，触发风控时自动减仓/平仓。",
      "complexity": 6,
      "priority": "P0",
      "dependencies": ["20"],
      "estimated_days": 2,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/product.md#user-story-44-t-004"
    },
    {
      "id": "22",
      "title": "实现紧急平仓功能 (T-005)",
      "description": "Dashboard 一键平仓按钮，API 紧急平仓接口，平仓前确认提示 (人工确认)，平仓结果 Telegram 通知。",
      "complexity": 4,
      "priority": "P0",
      "dependencies": ["21"],
      "estimated_days": 1,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/product.md#user-story-45-t-005"
    },
    {
      "id": "23",
      "title": "搭建 FastAPI 后端框架",
      "description": "创建 FastAPI 应用骨架，配置路由结构，实现 JWT 认证，添加 CORS 配置，设置 OpenAPI 文档。",
      "complexity": 4,
      "priority": "P0",
      "dependencies": ["0"],
      "estimated_days": 2,
      "status": "pending",
      "type": "architecture",
      "trace_to": "specs/architecture.md#api-design"
    },
    {
      "id": "24",
      "title": "实现因子管理 API",
      "description": "实现 POST /factors/generate, GET /factors, GET /factors/:id, POST /factors/:id/evaluate, PUT /factors/:id/status 接口。",
      "complexity": 5,
      "priority": "P0",
      "dependencies": ["23", "13"],
      "estimated_days": 2,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/architecture.md#api-design"
    },
    {
      "id": "25",
      "title": "实现研究账本 API",
      "description": "实现 GET /research/ledger, GET /research/stats, GET /metrics/thresholds 接口，支持分页和筛选。",
      "complexity": 4,
      "priority": "P0",
      "dependencies": ["23", "11"],
      "estimated_days": 1,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/architecture.md#api-design"
    },
    {
      "id": "26",
      "title": "实现 Pipeline 运行 API",
      "description": "实现 POST /pipeline/run, GET /pipeline/:id/status 接口，支持异步任务状态查询，WebSocket 进度推送。",
      "complexity": 5,
      "priority": "P0",
      "dependencies": ["23", "17"],
      "estimated_days": 2,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/architecture.md#api-design"
    },
    {
      "id": "27",
      "title": "搭建 React Dashboard 项目",
      "description": "创建 Vite + React + TypeScript 项目，配置 Tailwind CSS，安装 shadcn/ui 组件，设置路由和状态管理 (Zustand)。",
      "complexity": 4,
      "priority": "P1",
      "dependencies": ["0"],
      "estimated_days": 2,
      "status": "pending",
      "type": "architecture",
      "trace_to": "specs/architecture.md#frontend-stack"
    },
    {
      "id": "28",
      "title": "实现 Agent 状态监控页面 (D-001)",
      "description": "实现 AgentMonitor.tsx，展示 Agent 运行状态，任务队列可视化，LLM 延迟和成功率指标，资源使用监控。",
      "complexity": 5,
      "priority": "P1",
      "dependencies": ["27", "24"],
      "estimated_days": 2,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/product.md#user-story-51"
    },
    {
      "id": "29",
      "title": "实现因子浏览器页面 (D-002)",
      "description": "实现 FactorExplorer.tsx，因子库列表/筛选/搜索，因子详情展示，评估指标可视化，状态管理。",
      "complexity": 5,
      "priority": "P1",
      "dependencies": ["27", "24"],
      "estimated_days": 2,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/architecture.md#dashboard-pages"
    },
    {
      "id": "30",
      "title": "实现 Research Ledger 视图 (D-003)",
      "description": "实现 ResearchLedger.tsx，试验历史列表，动态阈值展示，全局统计图表，防过拟合状态可视化。",
      "complexity": 5,
      "priority": "P1",
      "dependencies": ["27", "25"],
      "estimated_days": 2,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/architecture.md#dashboard-pages"
    },
    {
      "id": "31",
      "title": "实现实盘监控面板 (D-004)",
      "description": "实现 LiveTrading.tsx，实时持仓展示，PnL 曲线图表，风控状态指示，紧急平仓按钮，WebSocket 实时更新。",
      "complexity": 6,
      "priority": "P1",
      "dependencies": ["27", "22"],
      "estimated_days": 3,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/architecture.md#dashboard-pages"
    },
    {
      "id": "32",
      "title": "配置 Celery 分布式任务队列",
      "description": "配置 Celery + Redis，实现回测任务异步执行，任务状态追踪，失败重试机制，任务优先级队列。",
      "complexity": 5,
      "priority": "P1",
      "dependencies": ["0"],
      "estimated_days": 2,
      "status": "pending",
      "type": "architecture",
      "trace_to": "specs/architecture.md#message-queue-stack"
    },
    {
      "id": "33",
      "title": "实现因子向量化存储 (Qdrant)",
      "description": "实现因子代码 embedding 生成，配置 Qdrant 向量存储，实现相似度检索 (阈值 0.85)，因子聚类基础。",
      "complexity": 6,
      "priority": "P1",
      "dependencies": ["0"],
      "estimated_days": 2,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/product.md#user-story-factor-dedup"
    },
    {
      "id": "34",
      "title": "配置监控告警系统",
      "description": "配置 Prometheus + Grafana，实现关键指标监控 (CPU/Memory/Latency/Error Rate)，配置 Telegram 告警通知。",
      "complexity": 5,
      "priority": "P1",
      "dependencies": ["0"],
      "estimated_days": 2,
      "status": "pending",
      "type": "architecture",
      "trace_to": "specs/architecture.md#monitoring-alerting"
    },
    {
      "id": "35",
      "title": "编写集成测试套件",
      "description": "编写端到端集成测试，覆盖因子生成→评估→策略→回测完整流程，测试覆盖率 ≥ 80%。",
      "complexity": 6,
      "priority": "P1",
      "dependencies": ["17", "13"],
      "estimated_days": 3,
      "status": "pending",
      "type": "feature",
      "trace_to": "specs/architecture.md#testing-strategy"
    },
    {
      "id": "36",
      "title": "配置 CI/CD 流水线",
      "description": "配置 GitHub Actions，实现自动测试、Docker 镜像构建、Staging 自动部署，Production 手动审批部署。",
      "complexity": 4,
      "priority": "P1",
      "dependencies": ["35"],
      "estimated_days": 2,
      "status": "pending",
      "type": "architecture",
      "trace_to": "specs/architecture.md#deployment-architecture"
    },
    {
      "id": "37",
      "title": "实现数据库备份与恢复",
      "description": "配置 TimescaleDB 自动备份 (hourly incremental, daily full)，Redis RDB + AOF 持久化，编写恢复脚本和演练文档。",
      "complexity": 4,
      "priority": "P1",
      "dependencies": ["0"],
      "estimated_days": 1,
      "status": "pending",
      "type": "architecture",
      "trace_to": "specs/architecture.md#disaster-recovery"
    }
  ],
  "metadata": {
    "last_updated": "2025-12-10",
    "total_tasks": 38,
    "completed_tasks": 6,
    "in_progress_tasks": 0,
    "priority_distribution": {
      "P0": 27,
      "P1": 11
    },
    "complexity_distribution": {
      "low_1_3": 1,
      "medium_4_6": 28,
      "high_7_10": 9
    },
    "type_distribution": {
      "architecture": 10,
      "feature": 28
    }
  },
  "stats": {
    "total": 38,
    "completed": 6,
    "in_progress": 0,
    "pending": 32,
    "blocked": 0
  }
}
